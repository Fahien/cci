## target architecture (if not defined in Makefile)
ifndef TARGET_ARCH
 TARGET_ARCH = macosx
endif

## Your SystemC installation path
ifdef SYSTEMC21V1
 SYSTEMC = /cad/tools/systemc2.1
 SCCFLAG = -DSYSTEMC21V1
else
 SYSTEMC = /cad/tools/systemc
endif

## Your compiler
CC = g++

## set some directories 
GS_CONTROL_DIR = /Users/schroede/mydev/greensocs_greencontrol
GREENSTARCORE_DIR = /Users/schroede/mydev/greensocs_greencontrol
CCI_DIR = /Users/schroede/mydev/greensocs_greencontrol/greenstarcore/api
BOOST = /cad/tools/boost

ifdef SYSTEMC21V1
 SCV_INCLUDE = /cad/tools/systemc2.1-scv/include
 SCV_LIB = /cad/tools/systemc2.1-scv/lib-$(TARGET_ARCH)
else
 SCV_INCLUDE = /cad/tools/systemc-scv/include
 SCV_LIB = /cad/tools/systemc-scv/lib-$(TARGET_ARCH)
endif

DEFFLAGS = -DSC_INCLUDE_DYNAMIC_PROCESSES


## muldefs should be avoided in the source code, not by the linker
LDFLAGS =

INCDIR = -I$(GS_CONTROL_DIR) -I$(BOOST) \
         -I. -I.. -I$(SYSTEMC)/include -I$(GREENSTARCORE_DIR) -I$(CCI_DIR)
LIBDIR = -L. -L.. -L$(SYSTEMC)/lib-$(TARGET_ARCH)

## here may be needed to write -lscv at the beginning - which also may cause problems!
LIBS   =  -lsystemc -lm $(EXTRA_LIBS)


EXE    = $(MODULE).x

.SUFFIXES: .cc .cpp .o .x

$(EXE): $(OBJS_W_PATHS) $(SYSTEMC)/lib-$(TARGET_ARCH)/libsystemc.a 
	$(CC) $(CFLAGS) $(SCCFLAG) $(DEFFLAGS) $(LDFLAGS) $(INCDIR) $(LIBDIR) -o $@ $(OBJS) $(LIBS) 2>&1 | c++filt
#	strip $(EXE)

.cpp.o:
	$(CC) $(CFLAGS) $(SCCFLAG) $(DEFFLAGS) $(INCDIR) -c $<

.cc.o:
	$(CC) $(CFLAGS) $(SCCFLAG) $(DEFFLAGS) $(INCDIR) -c $<

clean::
	rm -f $(OBJS) *~ $(EXE) core

ultraclean: clean
	rm -f Makefile.deps
